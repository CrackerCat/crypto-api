<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Unit tests</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/qunit/1.18.0/qunit.min.css">
</head>
<body>
<div id="qunit"></div>
<div id="qunit-fixture"></div>
</body>
<script src="../lib/crypto-api.js"></script>
<script src="../lib/enc.hex.js"></script>
<script src="../lib/hasher.md2.js"></script>
<script src="../lib/hasher.md4.js"></script>
<script src="../lib/hasher.md5.js"></script>
<script src="../lib/hasher.sha0.js"></script>
<script src="../lib/hasher.sha1.js"></script>
<script src="../lib/hasher.sha256.js"></script>
<script src="../lib/hasher.sha512.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qunit/1.18.0/qunit.min.js"></script>
<script>
    (function () {
        // The MD2 test suite
        // https://tools.ietf.org/html/rfc1319
        module("MD2");
        test("md2('')", function () {
            strictEqual(CryptoApi.hash('md2','',{}).stringify('hex'), '8350e5a3e24c153df2275c9f80692773', "Passed!");
        });
        test("md2('a')", function () {
            strictEqual(CryptoApi.hash('md2','a',{}).stringify('hex'), '32ec01ec4a6dac72c0ab96fb34c0b5d1', "Passed!");
        });
        test("md2('abc')", function () {
            strictEqual(CryptoApi.hash('md2','abc',{}).stringify('hex'), 'da853b0d3f88d99b30283a69e6ded6bb', "Passed!");
        });
        test("md2('message digest')", function () {
            strictEqual(CryptoApi.hash('md2','message digest',{}).stringify('hex'), 'ab4f496bfb2a530b219ff33031fe06b0', "Passed!");
        });
        test("md2('abcdefghijklmnopqrstuvwxyz')", function () {
            strictEqual(CryptoApi.hash('md2','abcdefghijklmnopqrstuvwxyz',{}).stringify('hex'), '4e8ddff3650292ab5a4108c3aa47940b', "Passed!");
        });
        test("md2('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789')", function () {
            strictEqual(CryptoApi.hash('md2','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',{}).stringify('hex'), 'da33def2a42df13975352846c30338cd', "Passed!");
        });
        test("md2('12345678901234567890123456789012345678901234567890123456789012345678901234567890')", function () {
            strictEqual(CryptoApi.hash('md2','12345678901234567890123456789012345678901234567890123456789012345678901234567890',{}).stringify('hex'), 'd5976f79d83d3a0dc9806c3c66f3efd8', "Passed!");
        });

        // The MD4 test suite
        // https://tools.ietf.org/html/rfc1320
        module( "MD4" );
        test("md4('')", function () {
            strictEqual(CryptoApi.hash('md4','',{}).stringify('hex'), '31d6cfe0d16ae931b73c59d7e0c089c0', "Passed!");
        });
        test("md4('a')", function () {
            strictEqual(CryptoApi.hash('md4','a',{}).stringify('hex'), 'bde52cb31de33e46245e05fbdbd6fb24', "Passed!");
        });
        test("md4('abc')", function () {
            strictEqual(CryptoApi.hash('md4','abc',{}).stringify('hex'), 'a448017aaf21d8525fc10ae87aa6729d', "Passed!");
        });
        test("md4('message digest')", function () {
            strictEqual(CryptoApi.hash('md4','message digest',{}).stringify('hex'), 'd9130a8164549fe818874806e1c7014b', "Passed!");
        });
        test("md4('abcdefghijklmnopqrstuvwxyz')", function () {
            strictEqual(CryptoApi.hash('md4','abcdefghijklmnopqrstuvwxyz',{}).stringify('hex'), 'd79e1c308aa5bbcdeea8ed63df412da9', "Passed!");
        });
        test("md4('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789')", function () {
            strictEqual(CryptoApi.hash('md4','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',{}).stringify('hex'), '043f8582f241db351ce627e153e7f0e4', "Passed!");
        });
        test("md4('12345678901234567890123456789012345678901234567890123456789012345678901234567890')", function () {
            strictEqual(CryptoApi.hash('md4','12345678901234567890123456789012345678901234567890123456789012345678901234567890',{}).stringify('hex'), 'e33b4ddc9c38f2199c3e7b164fcc0536', "Passed!");
        });

        // The MD5 test suite
        // https://tools.ietf.org/html/rfc1321
        module( "MD5" );
        test("md5('')", function () {
            strictEqual(CryptoApi.hash('md5','',{}).stringify('hex'), 'd41d8cd98f00b204e9800998ecf8427e', "Passed!");
        });
        test("md5('a')", function () {
            strictEqual(CryptoApi.hash('md5','a',{}).stringify('hex'), '0cc175b9c0f1b6a831c399e269772661', "Passed!");
        });
        test("md5('abc')", function () {
            strictEqual(CryptoApi.hash('md5','abc',{}).stringify('hex'), '900150983cd24fb0d6963f7d28e17f72', "Passed!");
        });
        test("md5('message digest')", function () {
            strictEqual(CryptoApi.hash('md5','message digest',{}).stringify('hex'), 'f96b697d7cb7938d525a2f31aaf161d0', "Passed!");
        });
        test("md5('abcdefghijklmnopqrstuvwxyz')", function () {
            strictEqual(CryptoApi.hash('md5','abcdefghijklmnopqrstuvwxyz',{}).stringify('hex'), 'c3fcd3d76192e4007dfb496cca67e13b', "Passed!");
        });
        test("md5('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789')", function () {
            strictEqual(CryptoApi.hash('md5','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',{}).stringify('hex'), 'd174ab98d277d9f5a5611c2c9f419d9f', "Passed!");
        });
        test("md5('12345678901234567890123456789012345678901234567890123456789012345678901234567890')", function () {
            strictEqual(CryptoApi.hash('md5','12345678901234567890123456789012345678901234567890123456789012345678901234567890',{}).stringify('hex'), '57edf4a22be3c955ac49da2e2107b67a', "Passed!");
        });

        // The SHA0 test suite
        // https://www.cosic.esat.kuleuven.be/nessie/testvectors/hash/sha/Sha-0-160.test-vectors
        module( "SHA0" );
        test("sha0('')", function () {
            strictEqual(CryptoApi.hash('sha0','',{}).stringify('hex'), 'f96cea198ad1dd5617ac084a3d92c6107708c0ef', "Passed!");
        });
        test("sha0('abc')", function () {
            strictEqual(CryptoApi.hash('sha0','abc',{}).stringify('hex'), '0164b8a914cd2a5e74c4f7ff082c4d97f1edf880', "Passed!");
        });
        test("sha0('abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq')", function () {
            strictEqual(CryptoApi.hash('sha0','abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq',{}).stringify('hex'), 'd2516ee1acfa5baf33dfc1c471e438449ef134c8', "Passed!");
        });
        test("sha0('a..') [1000000 times]", function () {
            var hash = CryptoApi.hasher('sha0',{});
            for(var i = 0; i < 1000; i++) {
                hash.update(new Array(1001).join('a'));
            }
            strictEqual(hash.finalize().stringify('hex'), '3232affa48628a26653b5aaa44541fd90d690603', "Passed!");
        });
        test("sha0('ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789')", function () {
            strictEqual(CryptoApi.hash('sha0','ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789',{}).stringify('hex'), '79e966f7a3a990df33e40e3d7f8f18d2caebadfa', "Passed!");
        });

        // The SHA1 test suite
        // http://tools.ietf.org/html/rfc3174
        // http://csrc.nist.gov/publications/fips/fips180-2/fips180-2.pdf
        // https://www.cosic.esat.kuleuven.be/nessie/testvectors/hash/sha/Sha-1-160.test-vectors
        module( "SHA1" );
        test("sha1('')", function () {
            strictEqual(CryptoApi.hash('sha1','', {}).stringify('hex'), 'da39a3ee5e6b4b0d3255bfef95601890afd80709', "Passed!");
        });
        test("sha1('abc')", function () {
            strictEqual(CryptoApi.hash('sha1','abc', {}).stringify('hex'), 'a9993e364706816aba3e25717850c26c9cd0d89d', "Passed!");
        });
        test("sha1('abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq')", function () {
            strictEqual(CryptoApi.hash('sha1','abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq', {}).stringify('hex'), '84983e441c3bd26ebaae4aa1f95129e5e54670f1', "Passed!");
        });
        test("sha1('a..') [1000000 times]", function () {
            var hash = CryptoApi.hasher('sha1',{});
            for(var i = 0; i < 1000; i++) {
                hash.update(new Array(1001).join('a'));
            }
            strictEqual(hash.finalize().stringify('hex'), '34aa973cd4c4daa4f61eeb2bdbad27316534016f', "Passed!");
        });
        test("sha1('0123456701234567012345670123456701234567012345670123456701234567..') [10 times]", function () {
            strictEqual(CryptoApi.hash('sha1',new Array(11).join('0123456701234567012345670123456701234567012345670123456701234567'), {}).stringify('hex'), 'dea356a2cddd90c7a7ecedc5ebb563934f460452', "Passed!");
        });

        // The SHA224 test suite
        // http://tools.ietf.org/html/rfc4634
        module( "SHA224" );
        test("sha224('')", function () {
            strictEqual(CryptoApi.hash('sha224','',{}).stringify('hex'), 'd14a028c2a3a2bc9476102bb288234c415a2b01f828ea62ac5b3e42f', "Passed!");
        });
        test("sha224('abc')", function () {
            strictEqual(CryptoApi.hash('sha224','abc',{}).stringify('hex'), '23097d223405d8228642a477bda255b32aadbce4bda0b3f7e36c9da7', "Passed!");
        });
        test("sha224('abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq')", function () {
            strictEqual(CryptoApi.hash('sha224','abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq',{}).stringify('hex'), '75388b16512776cc5dba5da1fd890150b0c6455cb4f58b1952522525', "Passed!");
        });
        test("sha224('a..') [1000000 times]", function () {
            var hash = CryptoApi.hasher('sha224',{});
            for(var i = 0; i < 1000; i++) {
                hash.update(new Array(1001).join('a'));
            }
            strictEqual(hash.finalize().stringify('hex'), '20794655980c91d8bbb4c1ea97618a4bf03f42581948b2ee4ee7ad67', "Passed!");
        });
        test("sha224('0123456701234567012345670123456701234567012345670123456701234567..') [10 times]", function () {
            strictEqual(CryptoApi.hash('sha224',new Array(11).join('0123456701234567012345670123456701234567012345670123456701234567'),{}).stringify('hex'), '567f69f168cd7844e65259ce658fe7aadfa25216e68eca0eb7ab8262', "Passed!");
        });

        // The SHA256 test suite
        // http://tools.ietf.org/html/rfc4634
        module( "SHA256" );
        test("sha256('')", function () {
            strictEqual(CryptoApi.hash('sha256','',{}).stringify('hex'), 'e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855', "Passed!");
        });
        test("sha256('abc')", function () {
            strictEqual(CryptoApi.hash('sha256','abc',{}).stringify('hex'), 'ba7816bf8f01cfea414140de5dae2223b00361a396177a9cb410ff61f20015ad', "Passed!");
        });
        test("sha256('abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq')", function () {
            strictEqual(CryptoApi.hash('sha256','abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq',{}).stringify('hex'), '248d6a61d20638b8e5c026930c3e6039a33ce45964ff2167f6ecedd419db06c1', "Passed!");
        });
        test("sha256('a..') [1000000 times]", function () {
            var hash = CryptoApi.hasher('sha256',{});
            for(var i = 0; i < 1000; i++) {
                hash.update(new Array(1001).join('a'));
            }

            strictEqual(hash.finalize().stringify('hex'), 'cdc76e5c9914fb9281a1c7e284d73e67f1809a48a497200e046d39ccc7112cd0', "Passed!");
        });
        test("sha256('0123456701234567012345670123456701234567012345670123456701234567..') [10 times]", function () {
            strictEqual(CryptoApi.hash('sha256',new Array(11).join('0123456701234567012345670123456701234567012345670123456701234567'),{}).stringify('hex'), '594847328451bdfa85056225462cc1d867d877fb388df0ce35f25ab5562bfbb5', "Passed!");
        });

      // The SHA512 test suite
      // http://tools.ietf.org/html/rfc4634
      module( "SHA512" );
      test("sha512('')", function () {
        strictEqual(CryptoApi.hash('sha512','',{}).stringify('hex'), 'cf83e1357eefb8bdf1542850d66d8007d620e4050b5715dc83f4a921d36ce9ce47d0d13c5d85f2b0ff8318d2877eec2f63b931bd47417a81a538327af927da3e', "Passed!");
      });
      test("sha512('abc')", function () {
        strictEqual(CryptoApi.hash('sha512','abc',{}).stringify('hex'), 'ddaf35a193617abacc417349ae20413112e6fa4e89a97ea20a9eeee64b55d39a2192992a274fc1a836ba3c23a3feebbd454d4423643ce80e2a9ac94fa54ca49f', "Passed!");
      });
      test("sha512('abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq')", function () {
        strictEqual(CryptoApi.hash('sha512','abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq',{}).stringify('hex'), '204a8fc6dda82f0a0ced7beb8e08a41657c16ef468b228a8279be331a703c33596fd15c13b1b07f9aa1d3bea57789ca031ad85c7a71dd70354ec631238ca3445', "Passed!");
      });
      test("sha512('a..') [1000000 times]", function () {
            var hash = CryptoApi.hasher('sha512',{});
            for(var i = 0; i < 1000; i++) {
                hash.update(new Array(1001).join('a'));
            }

            strictEqual(hash.finalize().stringify('hex'), 'e718483d0ce769644e2e42c7bc15b4638e1f98b13b2044285632a803afa973ebde0ff244877ea60a4cb0432ce577c31beb009c5c2c49aa2e4eadb217ad8cc09b', "Passed!");
      });
      test("sha512('0123456701234567012345670123456701234567012345670123456701234567..') [10 times]", function () {
        strictEqual(CryptoApi.hash('sha512',new Array(11).join('0123456701234567012345670123456701234567012345670123456701234567'),{}).stringify('hex'), '89d05ba632c699c31231ded4ffc127d5a894dad412c0e024db872d1abd2ba8141a0f85072a9be1e2aa04cf33c765cb510813a39cd5a84c4acaa64d3f3fb7bae9', "Passed!");
      });
    })(CryptoApi);
</script>
</html>